@startuml

title virtual threads

scale 1.0
hide footbox
'!pragma teoz true

skinparam monochrome true
skinparam defaultFontName Source Sans Pro
skinparam titleFontSize 15
skinparam titleFontStyle normal
skinparam sequenceMessageAlign left
skinparam participantBackgroundColor #white
skinparam noteBackgroundColor #white
skinparam sequenceGroupBackgroundColor #white

participant "virtual\nthread" as VirtualThread1
participant "continuation" as CarrierThread
participant "operation\nsystem" as Service

activate VirtualThread1
VirtualThread1->>CarrierThread : Continuation.run()
activate CarrierThread
||20||
VirtualThread1->>CarrierThread : Continuation.yield()
CarrierThread->>VirtualThread1
deactivate CarrierThread

||20||
VirtualThread1->>Service
deactivate VirtualThread1
activate Service

||80||

Service->>VirtualThread1
deactivate Service
activate VirtualThread1

VirtualThread1->>CarrierThread : Continuation.run()
activate CarrierThread
||20||
CarrierThread->>VirtualThread1
deactivate CarrierThread
deactivate VirtualThread1

@enduml
